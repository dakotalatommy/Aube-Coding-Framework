import{r as o,j as e}from"./react-vendor--lxKGBiW.js";import{a as s,g as c}from"./index-Bk3Do8do.js";import"./radix-Dc_FVRD7.js";import"./sentry-ZUDTCraJ.js";import"./howler-DHXmObXC.js";import"./physics-DQSz9XbC.js";import"./analytics-BPch_qa6.js";import"./supabase-CZcX4Eou.js";function F(){const[n,d]=o.useState({}),[r,u]=o.useState({}),[x,i]=o.useState(""),[y,j]=o.useState(""),[v,f]=o.useState([]),[h,_]=o.useState(""),[m,C]=o.useState("{}"),[S,p]=o.useState(""),[b,g]=o.useState({items:[],counts:{}});o.useEffect(()=>{(async()=>{try{const t=await s.get(`/admin/kpis?tenant_id=${encodeURIComponent(await c())}`);d(t||{})}catch{}try{const t=await s.get("/docs/checklist");j(t?.content||"")}catch{}try{const t=await s.get(`/ai/costs?tenant_id=${encodeURIComponent(await c())}`);u(t||{})}catch{}try{const t=await s.get("/ai/tools/schema");f(Array.isArray(t?.tools)?t.tools:[])}catch{}try{const t=await s.get(`/admin/tools/telemetry?tenant_id=${encodeURIComponent(await c())}&limit=50`);g(t||{items:[],counts:{}})}catch{}})()},[]);const w=async()=>{try{const t=await s.post("/marts/recompute",{tenant_id:await c()});i(JSON.stringify(t))}catch(t){i(String(t?.message||t))}},k=async()=>{try{const t=await s.post("/admin/provision_creator",{tenant_id:await c(),rate_limit_multiplier:5});i("Creator mode provisioned: "+JSON.stringify(t))}catch(t){i(String(t?.message||t))}},T=async()=>{try{const t=await s.get("/health");i("Health: "+JSON.stringify(t))}catch(t){i("Health check failed: "+String(t?.message||t))}},R=async()=>{try{const t=await s.get("/cache/health");i("Cache: "+JSON.stringify(t))}catch(t){i("Cache health failed: "+String(t?.message||t))}},A=async()=>{try{const t=await s.get("/auth/config_check");i("Auth config: "+JSON.stringify(t))}catch(t){i("Auth config check failed: "+String(t?.message||t))}},B=async(t="all")=>{try{const l=await s.post("/admin/cache/clear",{tenant_id:await c(),scope:t});i("Cache cleared: "+JSON.stringify(l))}catch(l){i(String(l?.message||l))}},N=async()=>{try{const t=await c(),l=JSON.parse(m||"{}"),O=await s.post("/ai/tools/qa",{tenant_id:t,name:h,params:l});p(JSON.stringify(O,null,2));try{const I=await s.get(`/admin/tools/telemetry?tenant_id=${encodeURIComponent(t)}&limit=50`);g(I||{items:[],counts:{}})}catch{}}catch(t){p(String(t?.message||t))}};return e.jsxs("div",{children:[e.jsx("h3",{style:{margin:"8px 0"},children:"Admin"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4,1fr)",gap:12,marginBottom:16},children:[e.jsx(a,{title:"Active Tenants",value:n?.active_tenants||0}),e.jsx(a,{title:"Messages 24h",value:n?.messages_24h||0}),e.jsx(a,{title:"Errors 24h",value:n?.errors_24h||0}),e.jsx(a,{title:"Uptime %",value:n?.uptime_pct||0})]}),e.jsxs("section",{style:{border:"1px solid #eee",borderRadius:8,padding:12,marginBottom:12},children:[e.jsx("div",{style:{fontWeight:600,marginBottom:6},children:"AI Metrics"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3,1fr)",gap:12},children:[e.jsx(a,{title:"AI chats",value:n?.ai_chat_used||0}),e.jsx(a,{title:"DB queries (tools)",value:n?.db_query_tool_used||0}),e.jsx(a,{title:"Insights served",value:n?.insights_served||0})]})]}),e.jsxs("section",{style:{border:"1px solid #eee",borderRadius:8,padding:12,marginBottom:12},children:[e.jsx("div",{style:{fontWeight:600,marginBottom:6},children:"AI Costs & Caps (today)"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4,1fr)",gap:12},children:[e.jsx(a,{title:"Tenant tokens",value:r?.tenant_tokens_today||0}),e.jsx(a,{title:"Global tokens",value:r?.global_tokens_today||0}),e.jsx(a,{title:"Tenant $",value:Number(r?.tenant_cost_usd_today||0).toFixed?Number(r?.tenant_cost_usd_today||0).toFixed(4):r?.tenant_cost_usd_today||0}),e.jsx(a,{title:"Global $",value:Number(r?.global_cost_usd_today||0).toFixed?Number(r?.global_cost_usd_today||0).toFixed(4):r?.global_cost_usd_today||0})]})]}),e.jsxs("div",{style:{display:"flex",gap:8,marginBottom:12},children:[e.jsx("button",{onClick:w,children:"Recompute Marts"}),e.jsx("button",{onClick:k,children:"Provision Creator Mode"}),e.jsx("button",{onClick:T,children:"Check Health"}),e.jsx("button",{onClick:R,children:"Check Cache"}),e.jsx("button",{onClick:A,children:"Check Auth Config"}),e.jsx("button",{onClick:()=>B("all"),children:"Clear Tenant Cache"})]}),e.jsxs("section",{style:{border:"1px solid #eee",borderRadius:8,padding:12,marginBottom:12},children:[e.jsx("div",{style:{fontWeight:600,marginBottom:6},children:"Tools QA"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:8},children:[e.jsxs("select",{value:h,onChange:t=>_(t.target.value),style:{padding:8,border:"1px solid #eee",borderRadius:8},children:[e.jsx("option",{value:"",children:"Select a tool"}),v.map(t=>e.jsx("option",{value:t.name,children:t.name},t.name))]}),e.jsx("button",{onClick:N,disabled:!h,children:"Run QA"})]}),e.jsx("div",{style:{fontSize:12,color:"#666",marginBottom:4},children:"Params (JSON)"}),e.jsx("textarea",{value:m,onChange:t=>C(t.target.value),rows:6,style:{width:"100%",border:"1px solid #eee",borderRadius:8,padding:8}})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:12,color:"#666",marginBottom:4},children:"Output"}),e.jsx("pre",{style:{whiteSpace:"pre-wrap",fontSize:12,border:"1px solid #eee",borderRadius:8,padding:12,maxHeight:220,overflow:"auto"},children:S||"—"}),e.jsx("div",{style:{fontSize:12,color:"#666",margin:"8px 0"},children:"Recent tool executions"}),e.jsx("div",{style:{fontSize:12,border:"1px solid #eee",borderRadius:8,padding:8,maxHeight:160,overflow:"auto"},children:(b.items||[]).map((t,l)=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",borderBottom:"1px solid #f2f2f2",padding:"4px 0"},children:[e.jsx("span",{children:new Date((Number(t.ts)||0)*1e3).toLocaleTimeString()}),e.jsx("span",{children:t.tool}),e.jsx("span",{children:t.status})]},l))})]})]})]}),e.jsx("pre",{style:{whiteSpace:"pre-wrap",marginTop:12},children:x}),e.jsxs("div",{style:{marginTop:16},children:[e.jsx("div",{style:{fontWeight:600,marginBottom:6},children:"Session Checklist"}),e.jsx("div",{style:{whiteSpace:"pre-wrap",fontSize:12,border:"1px solid #eee",borderRadius:8,padding:12,maxHeight:320,overflow:"auto"},children:y||"Loading…"})]})]})}function a({title:n,value:d}){return e.jsxs("div",{style:{border:"1px solid #eee",borderRadius:8,padding:12},children:[e.jsx("div",{style:{fontSize:12,color:"#666"},children:n}),e.jsx("div",{style:{fontSize:22,fontWeight:700},children:d})]})}export{F as default};
