import{r as a,j as e}from"./react-vendor--lxKGBiW.js";import{a as l,g as d}from"./index-Bk3Do8do.js";import"./radix-Dc_FVRD7.js";import"./sentry-ZUDTCraJ.js";import"./howler-DHXmObXC.js";import"./physics-DQSz9XbC.js";import"./analytics-BPch_qa6.js";import"./supabase-CZcX4Eou.js";function $(){const[m,N]=a.useState([]),[y,i]=a.useState(""),[s,u]=a.useState({contact_id:"c_demo",channel:"sms",service:"service"}),[r,p]=a.useState({contact_id:"c_demo",cadence_id:"warm_lead_default"}),[_,S]=a.useState([]),[v,b]=a.useState(null),[h,g]=a.useState([]),[f,c]=a.useState(!1);a.useEffect(()=>{(async()=>{try{const t=await l.get("/ai/tools/schema");N(t?.tools||[])}catch{}try{const t=await l.get(`/admin/audit?tenant_id=${encodeURIComponent(await d())}&limit=50`);S(t||[])}catch{}})()},[]),a.useEffect(()=>{const t=setTimeout(async()=>{try{const n=(s.contact_id||r.contact_id||"").trim();if(!n){g([]);return}const o=await l.get(`/contacts/search?tenant_id=${encodeURIComponent(await d())}&q=${encodeURIComponent(n)}&limit=8`);g(Array.isArray(o?.items)?o.items:[])}catch{g([])}},200);return()=>clearTimeout(t)},[s.contact_id,r.contact_id]);const C=async()=>{i("");try{const t=await l.post("/ai/tools/execute",{tenant_id:await d(),name:"draft_message",params:{tenant_id:await d(),...s},require_approval:!1});i(JSON.stringify(t))}catch(t){i(String(t?.message||t))}},R=async()=>{i("");try{const t=await l.post("/ai/tools/execute",{tenant_id:await d(),name:"start_cadence",params:{tenant_id:await d(),...r},require_approval:!0});i(JSON.stringify(t))}catch(t){i(String(t?.message||t))}},x=async(t,n={})=>{b(null);try{const o=await l.post(`/ai/proxy/${t}`,{tenant_id:await d(),payload:n});b(o)}catch(o){b({error:String(o?.message||o)})}};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Agent Panel"}),e.jsxs("section",{className:"border rounded-xl p-3 bg-white shadow-sm",children:[e.jsx("div",{className:"font-semibold mb-2",children:"Tool Registry"}),e.jsx("div",{className:"grid gap-2",children:m.map(t=>e.jsxs("div",{className:"flex items-start justify-between border rounded-md p-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:t.name}),e.jsx("div",{className:"text-sm text-slate-600",children:t.description})]}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-md ${t.public?"bg-green-50 text-green-700 border border-green-200":"bg-amber-50 text-amber-700 border border-amber-200"}`,children:t.public?"Public":"Gated"})]},t.name))})]}),e.jsxs("section",{className:"border rounded-xl p-3 bg-white shadow-sm",children:[e.jsx("div",{className:"font-semibold mb-2",children:"Run a Public Tool: draft_message"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{className:"border rounded-md px-3 py-2 w-full",placeholder:"contact_id",value:s.contact_id,onFocus:()=>c(!0),onBlur:()=>setTimeout(()=>c(!1),120),onChange:t=>u({...s,contact_id:t.target.value})}),f&&h.length>0&&e.jsx("div",{className:"absolute z-10 mt-1 max-h-40 overflow-auto bg-white border rounded-md shadow-sm text-xs w-full",children:h.map(t=>e.jsx("button",{className:"block w-full text-left px-2 py-1 hover:bg-slate-50",onMouseDown:n=>{n.preventDefault(),u({...s,contact_id:t.id}),c(!1)},children:t.name||t.id},t.id))})]}),e.jsxs("select",{className:"border rounded-md px-3 py-2",value:s.channel,onChange:t=>u({...s,channel:t.target.value}),children:[e.jsx("option",{value:"sms",children:"sms"}),e.jsx("option",{value:"email",children:"email"})]}),e.jsx("input",{className:"border rounded-md px-3 py-2",placeholder:"service",value:s.service,onChange:t=>u({...s,service:t.target.value})})]}),e.jsx("button",{className:"mt-2 border rounded-md px-3 py-2 bg-white hover:shadow-sm",onClick:C,children:"Draft"})]}),e.jsxs("section",{className:"border rounded-xl p-3 bg-white shadow-sm",children:[e.jsx("div",{className:"font-semibold mb-2",children:"Request a Gated Action: start_cadence (approval)"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{className:"border rounded-md px-3 py-2 w-full",placeholder:"contact_id",value:r.contact_id,onFocus:()=>c(!0),onBlur:()=>setTimeout(()=>c(!1),120),onChange:t=>p({...r,contact_id:t.target.value})}),f&&h.length>0&&e.jsx("div",{className:"absolute z-10 mt-1 max-h-40 overflow-auto bg-white border rounded-md shadow-sm text-xs w-full",children:h.map(t=>e.jsx("button",{className:"block w-full text-left px-2 py-1 hover:bg-slate-50",onMouseDown:n=>{n.preventDefault(),p({...r,contact_id:t.id}),c(!1)},children:t.name||t.id},t.id))})]}),e.jsx("input",{className:"border rounded-md px-3 py-2",placeholder:"cadence_id",value:r.cadence_id,onChange:t=>p({...r,cadence_id:t.target.value})})]}),e.jsx("button",{className:"mt-2 border rounded-md px-3 py-2 bg-white hover:shadow-sm",onClick:R,children:"Request Approval"})]}),e.jsx("pre",{className:"whitespace-pre-wrap text-sm text-slate-700",children:y}),e.jsxs("section",{className:"border rounded-xl p-3 bg-white shadow-sm",children:[e.jsx("div",{className:"font-semibold mb-2",children:"Edge Function Proxies"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{className:"border rounded-md px-3 py-2 bg-white hover:shadow-sm",onClick:()=>x("specialist-router",{query:"Route this to the right specialist"}),children:"Specialist Router"}),e.jsx("button",{className:"border rounded-md px-3 py-2 bg-white hover:shadow-sm",onClick:()=>x("ai-recommendations",{topic:"dashboard_insights"}),children:"AI Recommendations"}),e.jsx("button",{className:"border rounded-md px-3 py-2 bg-white hover:shadow-sm",onClick:()=>x("master-agent-orchestrator",{task:"plan_daily_actions"}),children:"Master Orchestrator"}),e.jsx("button",{className:"border rounded-md px-3 py-2 bg-white hover:shadow-sm",onClick:()=>x("realtime-token",{channel:"voice"}),children:"Realtime Token"})]}),e.jsxs("div",{className:"mt-2 text-sm",children:[e.jsx("div",{className:"font-medium",children:"Response"}),e.jsx("pre",{className:"whitespace-pre-wrap text-slate-700",children:v?JSON.stringify(v,null,2):"â€”"})]})]}),e.jsxs("section",{className:"border rounded-xl p-3 bg-white shadow-sm",children:[e.jsx("div",{className:"font-semibold mb-2",children:"Recent Tool Audit"}),e.jsx("div",{className:"overflow-hidden rounded-md border",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx(j,{children:"Time"}),e.jsx(j,{children:"Tool"}),e.jsx(j,{children:"Status"})]})}),e.jsx("tbody",{className:"divide-y",children:(_||[]).map(t=>e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx(w,{children:new Date((Number(t.ts)||0)*1e3).toLocaleString()}),e.jsx(w,{children:t.action||t.tool}),e.jsx(w,{children:t.status||"-"})]},t.id))})]})})]})]})}function j({children:m}){return e.jsx("th",{className:"text-left px-3 py-2 text-sm font-medium text-slate-600",children:m})}function w({children:m}){return e.jsx("td",{className:"px-3 py-2 text-sm text-slate-800",children:m})}export{$ as default};
