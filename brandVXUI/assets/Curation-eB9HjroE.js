import{r as i,j as t}from"./react-vendor--lxKGBiW.js";import{a as f,g as b}from"./index-Bk3Do8do.js";import"./radix-Dc_FVRD7.js";import"./sentry-ZUDTCraJ.js";import"./howler-DHXmObXC.js";import"./physics-DQSz9XbC.js";import"./analytics-BPch_qa6.js";import"./supabase-CZcX4Eou.js";function S(){const[l,r]=i.useState([]),[u,p]=i.useState(!0),[s,o]=i.useState(null),[a,c]=i.useState({kept:0,discarded:0}),m=async()=>{try{const e=await f.post("/curation/list",{tenant_id:await b(),limit:10});r(e?.items||[])}finally{p(!1)}};i.useEffect(()=>{m()},[]);const d=async(e,n)=>{await f.post("/curation/decide",{tenant_id:await b(),client_id:e,decision:n}),r(x=>x.filter(g=>g.client_id!==e)),o({client_id:e,decision:n}),c(x=>({kept:x.kept+(n==="keep"?1:0),discarded:x.discarded+(n==="discard"?1:0)}))},h=async()=>{s&&(await f.post("/curation/undo",{tenant_id:await b(),client_id:s.client_id}),r(e=>[{client_id:s.client_id,visits:0,services:[],total_minutes:0,revenue:0},...e]),c(e=>({kept:Math.max(0,e.kept-(s.decision==="keep"?1:0)),discarded:Math.max(0,e.discarded-(s.decision==="discard"?1:0))})),o(null))};return u?t.jsx("div",{children:"Loading…"}):t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h3",{className:"text-lg font-semibold",children:"Client Curation"}),t.jsxs("div",{className:"text-xs text-slate-700 bg-white/70 border border-white/70 rounded-md px-2 py-1",children:["Kept: ",a.kept," · Discarded: ",a.discarded]})]}),t.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:l.map(e=>t.jsxs(v,{onKeep:()=>d(e.client_id,"keep"),onDiscard:()=>d(e.client_id,"discard"),children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("div",{className:"font-medium text-slate-900",children:e.client_id}),t.jsxs("div",{className:"text-xs text-slate-600",children:["Visits: ",e.visits," · Minutes: ",e.total_minutes," · Revenue: $",e.revenue]})]}),t.jsxs("div",{className:"mt-3 flex gap-2",children:[t.jsx("button",{className:"px-3 py-2 rounded-md border bg-white hover:shadow-sm",onClick:()=>d(e.client_id,"discard"),children:"Discard"}),t.jsx("button",{className:"px-3 py-2 rounded-md bg-pink-500 text-white shadow-sm hover:bg-pink-600",onClick:()=>d(e.client_id,"keep"),children:"Keep"})]})]},e.client_id))}),s&&t.jsx("div",{className:"fixed bottom-4 left-1/2 -translate-x-1/2 z-30",children:t.jsxs("div",{className:"rounded-full border bg-white shadow px-3 py-2 text-xs text-slate-800 flex items-center gap-3",children:[t.jsx("span",{children:"Decision saved."}),t.jsx("button",{className:"px-2 py-1 rounded-md border bg-white hover:shadow-sm",onClick:h,children:"Undo"})]})}),l.length===0&&t.jsx("div",{className:"text-sm text-slate-600",children:"No clients pending curation. Import contacts or connect booking to continue."})]})}function v({children:l,onKeep:r,onDiscard:u}){const p=i.useRef(null),[s,o]=i.useState(0),[a,c]=i.useState(!1),m=i.useRef({x:0,y:0}),d=n=>{c(!0),m.current={x:n.clientX,y:n.clientY}},h=n=>{a&&o(n.clientX-m.current.x)},e=()=>{Math.abs(s)>120&&(s>0?r():u()),c(!1),o(0)};return t.jsxs("div",{ref:p,onMouseDown:d,onMouseMove:h,onMouseUp:e,onMouseLeave:()=>{a&&e()},className:"rounded-2xl p-4 bg-white/70 backdrop-blur border border-white/70 shadow-sm select-none",style:{transform:`translateX(${s}px) rotate(${s/40}deg)`,transition:a?"none":"transform 0.2s ease"},children:[t.jsxs("div",{className:"pointer-events-none absolute -mt-3 -ml-3 text-xs",children:[s>40?t.jsx("span",{className:"px-2 py-1 rounded-md bg-emerald-100 text-emerald-700 border border-emerald-200",children:"Keep"}):null,s<-40?t.jsx("span",{className:"px-2 py-1 rounded-md bg-rose-100 text-rose-700 border border-rose-200",children:"Discard"}):null]}),l]})}export{S as default};
